parameters:
  mygetApiKey: ''
  release: 'false'

steps:
  - bash: |
      if [ -z "$MYGET_API_KEY" ]; then
        echo "##vso[task.logissue type=error;]Missing template parameter \"mygetApiKey\""
        echo "##vso[task.complete result=Failed;]"
      fi
    env:
      MYGET_API_KEY: ${{ parameters.mygetApiKey }}
  - script: bash ./scripts/docker/init.sh
    displayName: "Setup Build Environment"
    env:
      MYGET_API_KEY: ${{ parameters.mygetApiKey }}
      RELEASE: ${{ parameters.release }}
  - script: bash ./scripts/docker/audit.sh
    displayName: "Audit packages"
  - script: bash ./scripts/docker/build.sh
    condition: succeeded()
    displayName: "Build Frontend Artifact"
  - script: bash ./scripts/docker/regression.sh
    condition: succeeded()
    displayName: "Running Regression Tests"
